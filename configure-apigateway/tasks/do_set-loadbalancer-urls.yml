---

  - name: Set variable defaults
    set_fact: 
      webmethods_apigateway_loadbalancer_request_body:
        httpUrls: "{{ webmethods_apigateway_loadbalancers_http_urls | default([]) | reject('match', '^\\s*$') | list }}"
        httpsUrls: "{{ webmethods_apigateway_loadbalancers_https_urls | default([]) | reject('match', '^\\s*$') | list }}"
        websocketUrls: "{{ webmethods_apigateway_loadbalancers_websocket_urls | default([]) | reject('match', '^\\s*$') | list }}"
        webAppUrl: "{{ webmethods_apigateway_loadbalancers_webapp_url | default('') }}"

  - debug: var=webmethods_apigateway_loadbalancer_request_body verbosity=3
  
  # "{{ lookup('template', 'apigateway_restapi_loadbalancer.json.j2') }}"

  - name: Update load balancer urls
    uri:
      url: "{{ apigateway_rest_configurations_loadBalancer }}"
      method: PUT
      user: "{{ apigateway_rest_login_username }}"
      password: "{{ apigateway_rest_login_password }}"
      return_content: yes
      body: "{{ webmethods_apigateway_loadbalancer_request_body | default({}) | to_json }}"
      force_basic_auth: yes
      validate_certs: false
      status_code: "200"
      body_format: json
      timeout: 30
    register: rest_response

  - name: Print response
    debug:
      var: rest_response.json
      verbosity: 3