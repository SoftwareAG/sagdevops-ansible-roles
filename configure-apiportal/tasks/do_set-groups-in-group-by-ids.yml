---

  - debug: var=apiportal_configparams_rest_groupsmgt_groups_in_group_uuids verbosity=3

  - name: only update groups if group-association variable defined
    block:

      - name: fail if mandatory param not specified
        fail: 
          msg: "A mandatory param was not defined, cannot do anything."
        when: item is not defined
        with_items:
          - "{{ apiportal_configparams_rest_groupsmgt_groups_in_group_uuids.group_parent }}"
          - "{{ apiportal_configparams_rest_groupsmgt_groups_in_group_uuids.group_children }}"

      - name: Create groups in group association
        uri:
          url: "{{ apiportal_configparams_rest_groupsmgt_path }}/{{ apiportal_configparams_rest_groupsmgt_groups_in_group_uuids.group_parent }}/children?tenant={{ apiportal_configparams_rest_tenant }}"
          method: POST
          user: "{{ apiportal_configparams_rest_auth_username }}"
          password: "{{ apiportal_configparams_rest_auth_password }}"
          return_content: yes
          body: "{{ apiportal_configparams_rest_groupsmgt_groups_in_group_uuids.group_children | default([]) | to_json }}"
          force_basic_auth: yes
          validate_certs: false
          status_code: [200, 201, 202, 204]
          body_format: json
          timeout: 30
        register: rest_response
        
      - name: Print response
        debug:
          var: rest_response.json
          verbosity: 3

    when: apiportal_configparams_rest_groupsmgt_groups_in_group_uuids is defined