---

- name: Check for wM afterInstallAsRoot
  stat: 
    path: "{{ webmethods_install_dir }}/bin/afterInstallAsRoot.sh"
  register: stat_afterInstallAsRootExecFile

- name: Run afterInstallAsRoot command
  command: "{{ webmethods_install_dir }}/bin/afterInstallAsRoot.sh"
  when: stat_afterInstallAsRootExecFile.stat.exists

- name: touch afterInstallAsRoot.success file to mark that it's been run before
  file:
    path: "{{ postinstall_file_marker }}"
    state: touch

- import_role: 
    name: server-reboot
  vars:
    server_reboot_timeout: 1000
  when: postinstall_do_reboot|bool